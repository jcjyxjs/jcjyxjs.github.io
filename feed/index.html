<?xml version='1.0' encoding='UTF-8'?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" version="2.0"><channel><title>毫无作为</title><link>/</link><description>永远年轻，永远热泪盈眶。</description><docs>http://www.rssboard.org/rss-specification</docs><generator>python-feedgen</generator><image><url>/favicon.ico</url><title>毫无作为</title><link>/</link></image><language>english</language><lastBuildDate>Mon, 20 Sep 2021 20:43:17 +0806</lastBuildDate><pubDate>Mon, 20 Sep 2021 20:43:17 +0806</pubDate><item><title>瑞幸冰镇杨梅瑞纳冰</title><link>/archives/20210612/</link><description>&lt;html&gt;
&lt;p style="display:inline;"&gt;铺天盖地的宣传让从来么有喝过的我尝试了一下，跟酸梅汁味道一模一样，太难喝了。太亏了，顶着个大太阳特地去买。&lt;/p&gt;
&lt;img src="https://cdn.elstec.cn/36/3.jpg" style="display: inline;"&gt;
&lt;/html&gt;
&lt;div class="photoset"&gt;&lt;div class="photos"&gt;&lt;figure class="pswp-item" style="flex: 23.104265402843602" &gt;&lt;img loading="lazy" width="1170" height="2532" src="https://cdn.elstec.cn/36/2.jpg" /&gt;&lt;/figure&gt;&lt;figure class="pswp-item" style="flex: 28.12349252291365" &gt;&lt;img loading="lazy" width="1166" height="2073" src="https://cdn.elstec.cn/36/1.jpg" /&gt;&lt;/figure&gt;&lt;/div&gt;&lt;/div&gt;</description><author>i@elstec.cn (jcjyxjs)</author><guid isPermaLink="true">/archives/20210612/</guid><pubDate>Sat, 12 Jun 2021 12:00:00 +0806</pubDate></item><item><title>Valine自定义表情包</title><link>/archives/20210615/</link><description>&lt;p&gt;获取最新版本&lt;code&gt;Valine&lt;/code&gt;，截至目前为止最新版本是&lt;code&gt;1.4.14&lt;/code&gt;，格式化与否都可。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://unpkg.com/valine/dist/Valine.min.js
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;搜索&lt;code&gt;sina&lt;/code&gt;字段。&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="s2"&gt;&amp;quot;use strict&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                    &lt;span class="nx"&gt;t&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;__esModule&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="mf"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                    &lt;span class="nx"&gt;t&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;DEFAULT_EMOJI_CDN&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                        &lt;span class="nx"&gt;t&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;DB_NAME&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Comment&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                        &lt;span class="nx"&gt;t&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;defaultConfig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                            &lt;span class="nx"&gt;lang&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;zh-CN&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                            &lt;span class="nx"&gt;langMode&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                            &lt;span class="nx"&gt;appId&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                            &lt;span class="nx"&gt;appKey&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                            &lt;span class="nx"&gt;clazzName&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Comment&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                            &lt;span class="nx"&gt;meta&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;nick&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;mail&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;link&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                            &lt;span class="nx"&gt;path&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;location&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;pathname&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                            &lt;span class="nx"&gt;placeholder&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Just Go Go&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                            &lt;span class="nx"&gt;pageSize&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                            &lt;span class="nx"&gt;recordIP&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="mf"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                            &lt;span class="nx"&gt;serverURLs&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                            &lt;span class="nx"&gt;visitor&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                            &lt;span class="nx"&gt;emojiCDN&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                            &lt;span class="nx"&gt;emojiMaps&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="ow"&gt;void&lt;/span&gt; &lt;span class="mf"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                            &lt;span class="nx"&gt;enableQQ&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                            &lt;span class="nx"&gt;requiredFields&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
                        &lt;span class="p"&gt;},&lt;/span&gt;
                        &lt;span class="nx"&gt;t&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;defaultMeta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;nick&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;mail&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;link&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                        &lt;span class="nx"&gt;t&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;QQCacheKey&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;_v_Cache_Q&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                        &lt;span class="nx"&gt;t&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;MetaCacheKey&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;_v_Cache_Meta&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                        &lt;span class="nx"&gt;t&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;RandomStr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;Date&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;now&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;Math&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;round&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;1e3&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="nb"&gt;Math&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;random&lt;/span&gt;&lt;span class="p"&gt;())).&lt;/span&gt;&lt;span class="nx"&gt;toString&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;32&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                        &lt;span class="nx"&gt;t&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;VERSION&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;1.4.14&amp;quot;&lt;/span&gt;
                &lt;span class="p"&gt;},&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;修改其中的&lt;code&gt;emojiCDN&lt;/code&gt;和&lt;code&gt;emojiMaps&lt;/code&gt;字段内容。我选择&lt;code&gt;GitHub+jsdelivr&lt;/code&gt;高配置[doge]，&lt;code&gt;emojiCDN&lt;/code&gt;是域名，&lt;code&gt;emojiMaps&lt;/code&gt;是路径，合起来可以请求到一张图片。例：&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/2c/2018new_qinqin_thumb.png&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;其中&lt;code&gt;img.t.sinajs.cn/t4/appstyle/expression/ext/normal/&lt;/code&gt;就是&lt;code&gt;emojiCDN&lt;/code&gt;，&lt;code&gt;2c/2018new_qinqin_thumb.png&lt;/code&gt;就是&lt;code&gt;emojiMaps&lt;/code&gt;。其中&lt;code&gt;emojiMaps&lt;/code&gt;部分需要按照格式，例：&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nx"&gt;s2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;alu/2.png&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="c1"&gt;//表情包名称无空格可以不加引号&lt;/span&gt;
&lt;span class="s2"&gt;&amp;quot;sss 2&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;alu/2.png&amp;quot;&lt;/span&gt;&lt;span class="c1"&gt;//表情包名称含空格需加引号&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;发一条评论试试吧~&lt;/p&gt;</description><author>i@elstec.cn (jcjyxjs)</author><guid isPermaLink="true">/archives/20210615/</guid><pubDate>Tue, 15 Jun 2021 20:00:00 +0806</pubDate></item><item><title>Grafana+Prometheus监控服务器</title><link>/archives/20210620/</link><description>&lt;div class="notice"&gt;环境：Centos7，Supervisor持久化运行&lt;/div&gt;&lt;p&gt;下载以及安装Grafana，需要放通&lt;code&gt;3000&lt;/code&gt;端口用于Grafana的网页后台控制。&lt;em&gt;（IP:3000）&lt;/em&gt;&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;wget https://dl.grafana.com/oss/release/grafana-8.0.3-1.x86_64.rpm
sudo yum install grafana-8.0.3-1.x86_64.rpm
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;用&lt;code&gt;.deb&lt;/code&gt;或&lt;code&gt;.rpm&lt;/code&gt;安装完成之后可以用&lt;code&gt;systemd&lt;/code&gt;或&lt;code&gt;init.d&lt;/code&gt;控制。&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo systemctl daemon-reload
sudo systemctl start grafana-server
sudo systemctl status grafana-server
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;登入后台，默认用户名密码&lt;code&gt;admin&lt;/code&gt;，首次登录会被要求强制修改密码。&lt;/p&gt;&lt;p&gt;安装Prometheus，找到最新版，截至目前是2.28.0 &lt;code&gt;https://github.com/prometheus/prometheus/releases/&lt;/code&gt; &lt;em&gt;（外网访问需要放通9090端口）&lt;/em&gt;&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;wget https://github.com/prometheus/prometheus/releases/download/v2.28.0-rc.0/prometheus-2.28.0-rc.0.linux-amd64.tar.gz
tar -xzvf prometheus-2.28.0-rc.0.linux-amd64.tar.gz
&lt;span class="nb"&gt;cd&lt;/span&gt; prometheus-2.28.0-rc.0.linux-amd64
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;编辑&lt;code&gt;prometheus.yml&lt;/code&gt;文件，官方默认配置文件如下，默认监控Prometheus自身。&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# my global config&lt;/span&gt;
&lt;span class="nt"&gt;global&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;scrape_interval&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;     &lt;span class="l l-Scalar l-Scalar-Plain"&gt;15s&lt;/span&gt; &lt;span class="c1"&gt;# Set the scrape interval to every 15 seconds. Default is every 1 minute.&lt;/span&gt;
  &lt;span class="nt"&gt;evaluation_interval&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;15s&lt;/span&gt; &lt;span class="c1"&gt;# Evaluate rules every 15 seconds. The default is every 1 minute.&lt;/span&gt;
  &lt;span class="c1"&gt;# scrape_timeout is set to the global default (10s).&lt;/span&gt;

&lt;span class="c1"&gt;# Alertmanager configuration&lt;/span&gt;
&lt;span class="nt"&gt;alerting&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="nt"&gt;alertmanagers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;static_configs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;targets&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="c1"&gt;# - alertmanager:9093&lt;/span&gt;

&lt;span class="c1"&gt;# Load rules once and periodically evaluate them according to the global &amp;#39;evaluation_interval&amp;#39;.&lt;/span&gt;
&lt;span class="nt"&gt;rule_files&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="c1"&gt;# - &amp;quot;first_rules.yml&amp;quot;&lt;/span&gt;
  &lt;span class="c1"&gt;# - &amp;quot;second_rules.yml&amp;quot;&lt;/span&gt;

&lt;span class="c1"&gt;# A scrape configuration containing exactly one endpoint to scrape:&lt;/span&gt;
&lt;span class="c1"&gt;# Here it&amp;#39;s Prometheus itself.&lt;/span&gt;
&lt;span class="nt"&gt;scrape_configs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="c1"&gt;# The job name is added as a label `job=` to any timeseries scraped from this config.&lt;/span&gt;
  &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;job_name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;prometheus&amp;#39;&lt;/span&gt;

    &lt;span class="c1"&gt;# metrics_path defaults to &amp;#39;/metrics&amp;#39;&lt;/span&gt;
    &lt;span class="c1"&gt;# scheme defaults to &amp;#39;http&amp;#39;.&lt;/span&gt;

    &lt;span class="nt"&gt;static_configs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;targets&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p p-Indicator"&gt;[&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;localhost:9090&amp;#39;&lt;/span&gt;&lt;span class="p p-Indicator"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;#全局时间间隔&lt;/span&gt;
scrape_interval: 15s 
&lt;span class="c1"&gt;#规则扫描时间间隔&lt;/span&gt;
evaluation_interval: 15s 
&lt;span class="c1"&gt;#超时时间&lt;/span&gt;
scrape_timeout: 5s
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;更详细的可以参考官方文档：&lt;a href="https://prometheus.io/docs/prometheus/latest/configuration/configuration/"&gt;&lt;a href="https://prometheus.io/docs/prometheus/latest/configuration/configuration/"&gt;https://prometheus.io/docs/prometheus/latest/configuration/configuration/&lt;/a&gt;&lt;/a&gt;&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;./prometheus
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;网页后台：&lt;code&gt;IP:9090&lt;/code&gt;可以看到自身的状态是&lt;code&gt;UP&lt;/code&gt;。&lt;/p&gt;&lt;p&gt;node_exporter就是获取宿主机的资源信息，CPU占用，内存占用等&lt;/p&gt;&lt;p&gt;安装node_exporter，找到最新版，截至目前是1.1.2 
&lt;code&gt;https://github.com/prometheus/node_exporter/releases/&lt;/code&gt;  &lt;em&gt;（外网访问需要放通9100端口）&lt;/em&gt;&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;wget https://github.com/prometheus/node_exporter/releases/download/v1.1.2/node_exporter-1.1.2.linux-amd64.tar.gz
tar -xzvf node_exporter-1.1.2.linux-amd64.tar.gz
&lt;span class="nb"&gt;cd&lt;/span&gt; node_exporter-1.1.2.linux-amd64
./node_exporter
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Prometheus创建job获取node_exporter的数据，&lt;code&gt;job_name&lt;/code&gt;可以随便取。修改yml文件一定要严格注意格式（缩进）。&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;job_name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;exporter&amp;#39;&lt;/span&gt;
    &lt;span class="nt"&gt;static_configs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;targets&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p p-Indicator"&gt;[&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;localhost:9100&amp;#39;&lt;/span&gt;&lt;span class="p p-Indicator"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;然后重启Prometheus，网页后台可以看到这个job上线了。&lt;/p&gt;&lt;p&gt;重新回到Grafana网页后台，可以自己创建Dashboard，也可以用现成的。进入官方库：&lt;a href="https://grafana.com/grafana/dashboards"&gt;&lt;a href="https://grafana.com/grafana/dashboards"&gt;https://grafana.com/grafana/dashboards&lt;/a&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;也可以用这个：&lt;a href="https://grafana.com/grafana/dashboards/8919"&gt;&lt;a href="https://grafana.com/grafana/dashboards/8919"&gt;https://grafana.com/grafana/dashboards/8919&lt;/a&gt;&lt;/a&gt;&lt;/p&gt;&lt;figure class="pswp-item" style="flex: 63.57827476038339" &gt;&lt;img loading="lazy" width="398" height="313" src="https://cdn.elstec.cn/37/1.png" /&gt;&lt;/figure&gt;&lt;p&gt;复制数字，回到后台，点左侧加号然后&lt;code&gt;Import&lt;/code&gt;，输入数字ID点&lt;code&gt;Load&lt;/code&gt;，&lt;code&gt;VictoriaMetrics&lt;/code&gt;选择&lt;code&gt;Prometheus&lt;/code&gt;，最后&lt;code&gt;Import&lt;/code&gt;即可。&lt;/p&gt;&lt;figure class="pswp-item" style="flex: 52.17391304347826" &gt;&lt;img loading="lazy" width="1128" height="1081" src="https://cdn.elstec.cn/37/2.png" /&gt;&lt;/figure&gt;&lt;p&gt;最终效果可以观看我的：&lt;a href="https://status.elstec.cn/d/fcJIWBR7z/jcjyxjs?orgId=1"&gt;&lt;a href="https://status.elstec.cn/d/fcJIWBR7z/jcjyxjs?orgId=1"&gt;https://status.elstec.cn/d/fcJIWBR7z/jcjyxjs?orgId=1&lt;/a&gt;&lt;/a&gt;&lt;/p&gt;</description><author>i@elstec.cn (jcjyxjs)</author><guid isPermaLink="true">/archives/20210620/</guid><pubDate>Sun, 20 Jun 2021 20:00:00 +0806</pubDate></item><item><title>使用CloudFlare Argo Tunnel在无公网环境下内网穿透（打洞）</title><link>/archives/20210628/</link><description>&lt;p&gt;首先下载&lt;code&gt;Cloudflared&lt;/code&gt;，我是Windows，其他平台都差不多。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://developers.cloudflare.com/cloudflare-one/connections/connect-apps/install-and-setup/installation
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Windows下我用的&lt;code&gt;PowerShell 7.1.3&lt;/code&gt;，首先需要登录cloudflare账户，会自动打开默认浏览器登录。不建议用随机分配的域名，每次重启软件都会再次随机域名。&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cloudflared login
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;浏览器中选择tunnel绑定那个域名，点击授权。首次运行&lt;code&gt;cloudflared&lt;/code&gt;之后会在同目录下生成&lt;code&gt;config.yml&lt;/code&gt;，运行多条隧道需要配置该文件。&lt;/p&gt;&lt;p&gt;比方运行单条隧道，跳过&lt;code&gt;config.yml&lt;/code&gt;。&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cloudflared tunnel --hostname 访问的域名 --url IP:端口
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;配合自选IP可以达到速度最大化。配置文件开多条隧道试了一下一直失败，但是多开几个cmd或者powershell就可以成功。（bad）内网服务不仅限于web，也可以ssh等。&lt;/p&gt;</description><author>i@elstec.cn (jcjyxjs)</author><guid isPermaLink="true">/archives/20210628/</guid><pubDate>Mon, 28 Jun 2021 20:00:00 +0806</pubDate></item><item><title>自提100周年纪念品（邮折和纪念封）</title><link>/archives/20210801/</link><description>&lt;p&gt;发这篇文的时候已经是有点晚了，100周年纪念品预售时间是&lt;code&gt;2021年6月24日上午9点-6月28日下午6点&lt;/code&gt;，自提开始时间是&lt;code&gt;2021年7月23日下午5点&lt;/code&gt;。&lt;/p&gt;&lt;div class="photos"&gt;
&lt;figure class="pswp-item" style="flex: 23.106546854942234" &gt;&lt;img loading="lazy" width="1080" height="2337" src="https://cdn.elstec.cn/38/3.jpg" /&gt;&lt;/figure&gt;
&lt;figure class="pswp-item" style="flex: 23.104265402843602" &gt;&lt;img loading="lazy" width="1170" height="2532" src="https://cdn.elstec.cn/38/9.png" /&gt;&lt;/figure&gt;
&lt;/div&gt;&lt;p&gt;我买了一个邮折和一个纪念封，早知道纪念封可以买3份就全买了（BAD），不过有一说一设计和做工都还不错。&lt;/p&gt;&lt;div class="photos"&gt;
&lt;figure class="pswp-item" style="flex: 66.66666666666667" &gt;&lt;img loading="lazy" width="1440" height="1080" src="https://cdn.elstec.cn/38/1.jpg" /&gt;&lt;figcaption&gt;下暴雨曹娥江的水直接漫出来（习惯性打钱塘江xd）&lt;/figcaption&gt;&lt;/figure&gt;
&lt;figure class="pswp-item" style="flex: 23.104265402843602" &gt;&lt;img loading="lazy" width="1170" height="2532" src="https://cdn.elstec.cn/38/2.png" /&gt;&lt;figcaption&gt;我还在台风影响范围内哭了&lt;/figcaption&gt;&lt;/figure&gt;
&lt;/div&gt;&lt;p&gt;由于台风影响周五并没有去提货，周六去被告知集邮公司双休md，顶着台风白跑一趟。&lt;/p&gt;&lt;p&gt;我就准备周一自提，周一刚好麦当劳是麦麦脆汁鸡的活动，微信支付宝各领一张券下两次单，免费的东西必须要领的hhh。&lt;/p&gt;&lt;div class="photos"&gt;
&lt;figure class="pswp-item" style="flex: 23.106546854942234" &gt;&lt;img loading="lazy" width="1080" height="2337" src="https://cdn.elstec.cn/38/4.jpg" /&gt;&lt;/figure&gt;
&lt;figure class="pswp-item" style="flex: 23.106546854942234" &gt;&lt;img loading="lazy" width="1080" height="2337" src="https://cdn.elstec.cn/38/5.jpg" /&gt;&lt;/figure&gt;
&lt;figure class="pswp-item" style="flex: 66.66666666666667" &gt;&lt;img loading="lazy" width="1440" height="1080" src="https://cdn.elstec.cn/38/6.jpg" /&gt;&lt;/figure&gt;
&lt;/div&gt;&lt;p&gt;最后是上手，手感非常不错，加6块买的壳还是很好的。30块这个是有一个壳，24块只有邮票，就像图二，图一就有一个壳，不过刚好下雨邮票没坏就行。&lt;/p&gt;&lt;div class="photos"&gt;
&lt;figure class="pswp-item" style="flex: 37.5" &gt;&lt;img loading="lazy" width="3024" height="4032" src="https://cdn.elstec.cn/38/7-2.jpg" /&gt;&lt;/figure&gt;
&lt;figure class="pswp-item" style="flex: 37.5" &gt;&lt;img loading="lazy" width="3024" height="4032" src="https://cdn.elstec.cn/38/8-2.jpg" /&gt;&lt;/figure&gt;
&lt;/div&gt;&lt;p&gt;其实买一个也没啥不好的，主要还是做纪念，也没人会把这个拿去用，这辈子可能也遇不到第二个100年了。&lt;/p&gt;</description><author>i@elstec.cn (jcjyxjs)</author><guid isPermaLink="true">/archives/20210801/</guid><pubDate>Sun, 01 Aug 2021 00:00:00 +0806</pubDate></item><item><title>敦煌-西宁反向6日游</title><link>/archives/20210815/</link><description>&lt;div id="aplayer"&gt;
&lt;meting-js
server="netease"
type="song"
id="346089"
autoplay="false"&gt;
&lt;/meting-js&gt;
&lt;/div&gt;
&lt;p&gt;完整的路线不是我定的，全程跟着亲戚。首先好像是找了一个本地旅行社，加我大概4个人算是开了一个小团，一个本地人兼驾驶员兼（半吊子）导游。机票买的&lt;code&gt;萧山→敦煌&lt;/code&gt;，所以只能制定一条反向旅游线路。本来应该是&lt;code&gt;西宁→敦煌&lt;/code&gt;。&lt;/p&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
  &lt;th style="text-align:center"&gt;7月8日&lt;/th&gt;
  &lt;th style="text-align:center"&gt;7月9日&lt;/th&gt;
  &lt;th style="text-align:center"&gt;7月10日&lt;/th&gt;
  &lt;th style="text-align:center"&gt;7月11日&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
  &lt;td style="text-align:center"&gt;敦煌&lt;/td&gt;
  &lt;td style="text-align:center"&gt;敦煌&lt;/td&gt;
  &lt;td style="text-align:center"&gt;大柴旦&lt;/td&gt;
  &lt;td style="text-align:center"&gt;茶卡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td style="text-align:center"&gt;莫高窟&lt;/td&gt;
  &lt;td style="text-align:center"&gt;阳关遗址&lt;/td&gt;
  &lt;td style="text-align:center"&gt;翡翠湖&lt;/td&gt;
  &lt;td style="text-align:center"&gt;青海湖&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td style="text-align:center"&gt;鸣沙山月牙泉&lt;/td&gt;
  &lt;td style="text-align:center"&gt;石油小镇&lt;/td&gt;
  &lt;td style="text-align:center"&gt;茶卡盐湖&lt;/td&gt;
  &lt;td style="text-align:center"&gt;倒淌河&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td style="text-align:center"&gt;沙州夜市&lt;/td&gt;
  &lt;td style="text-align:center"&gt;青海雅丹&lt;/td&gt;
  &lt;td style="text-align:center"&gt;茶卡&lt;/td&gt;
  &lt;td style="text-align:center"&gt;日月山&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td style="text-align:center"&gt;敦煌市&lt;/td&gt;
  &lt;td style="text-align:center"&gt;大柴旦&lt;/td&gt;
  &lt;td style="text-align:center"&gt;&lt;/td&gt;
  &lt;td style="text-align:center"&gt;塔尔寺&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td style="text-align:center"&gt;&lt;/td&gt;
  &lt;td style="text-align:center"&gt;&lt;/td&gt;
  &lt;td style="text-align:center"&gt;&lt;/td&gt;
  &lt;td style="text-align:center"&gt;西宁&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;计划是7月7日-7月12日，6天。去程买的7号早上06:10，也就是我要3点起来，4点多出发走高速到萧山机场（具体时间我也忘记了），中途要在咸阳转机最后才到敦煌。&lt;/p&gt;&lt;div class="photos"&gt;
&lt;figure class="pswp-item" style="flex: 23.104265402843602" &gt;&lt;img loading="lazy" width="1170" height="2532" src="https://cdn.elstec.cn/39/1.jpg" /&gt;&lt;/figure&gt;
&lt;figure class="pswp-item" style="flex: 23.104265402843602" &gt;&lt;img loading="lazy" width="1170" height="2532" src="https://cdn.elstec.cn/39/2.jpg" /&gt;&lt;/figure&gt;
&lt;/div&gt;&lt;html&gt;
&lt;p style="display:inline;"&gt;上午的航班08:35就到咸阳机场，但是下午转机的班次在15:10，要在机场等大半天真无语到了0，太无聊了md&lt;/p&gt;
&lt;img src="https://cdn.elstec.cn/images/file_1016383.jpg" width="55px" height="55px" style="display: inline;"&gt;
&lt;/html&gt;
&lt;p&gt;晚上入住了一个不知名的商务酒店，两个标间加起来一晚800+，反正我个人觉得并不划算，但好像那边物价都比较高，买了一碗炒青菜根花了&lt;code&gt;32￥&lt;/code&gt;，炒的味道还可以，就是贵。&lt;/p&gt;&lt;figure class="pswp-item" style="flex: 37.5" &gt;&lt;img loading="lazy" width="3024" height="4032" src="https://cdn.elstec.cn/39/3.jpg" /&gt;&lt;figcaption&gt;晚上9点左右&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;其他就是太阳落山时间太晚了，不看手机都不知道已经7，8点多了（捂脸）。&lt;/p&gt;&lt;p&gt;7月8日正式开始旅游，上午去了必去景区&lt;code&gt;莫高窟&lt;/code&gt;，由于我不太拍照就照片超级少。&lt;/p&gt;&lt;div class="photos"&gt;
&lt;figure class="pswp-item" style="flex: 66.66666666666667" &gt;&lt;img loading="lazy" width="4032" height="3024" src="https://cdn.elstec.cn/39/4.jpg" /&gt;&lt;/figure&gt;
&lt;figure class="pswp-item" style="flex: 28.12370278123703" &gt;&lt;img loading="lazy" width="1355" height="2409" src="https://cdn.elstec.cn/39/5.jpg" /&gt;&lt;/figure&gt;
&lt;/div&gt;&lt;div class="photos"&gt;
&lt;figure class="pswp-item" style="flex: 37.5" &gt;&lt;img loading="lazy" width="3024" height="4032" src="https://cdn.elstec.cn/39/6.jpg" /&gt;&lt;/figure&gt;
&lt;figure class="pswp-item" style="flex: 28.122448979591837" &gt;&lt;img loading="lazy" width="1378" height="2450" src="https://cdn.elstec.cn/39/7.jpg" /&gt;&lt;/figure&gt;
&lt;/div&gt;&lt;p&gt;下午去的&lt;code&gt;鸣沙山月牙泉&lt;/code&gt;，出来已经晚上7点多，太阳还是好晒，但晚上真的太晚了夜市才探索了一半，还有一半超级好没去就感觉挺亏的。&lt;/p&gt;&lt;div class="photos"&gt;
&lt;figure class="pswp-item" style="flex: 95.93345656192237" &gt;&lt;img loading="lazy" width="3114" height="1623" src="https://cdn.elstec.cn/39/8.jpg" /&gt;&lt;/figure&gt;
&lt;figure class="pswp-item" style="flex: 66.66666666666667" &gt;&lt;img loading="lazy" width="4032" height="3024" src="https://cdn.elstec.cn/39/9.jpg" /&gt;&lt;/figure&gt;
&lt;/div&gt;&lt;div class="photos"&gt;
&lt;figure class="pswp-item" style="flex: 37.5" &gt;&lt;img loading="lazy" width="3024" height="4032" src="https://cdn.elstec.cn/39/10.jpg" /&gt;&lt;/figure&gt;
&lt;figure class="pswp-item" style="flex: 66.66666666666667" &gt;&lt;img loading="lazy" width="4032" height="3024" src="https://cdn.elstec.cn/39/11.jpg" /&gt;&lt;/figure&gt;
&lt;/div&gt;&lt;div class="photos"&gt;
&lt;figure class="pswp-item" style="flex: 66.66666666666667" &gt;&lt;img loading="lazy" width="4032" height="3024" src="https://cdn.elstec.cn/39/12.jpg" /&gt;&lt;/figure&gt;
&lt;figure class="pswp-item" style="flex: 66.66666666666667" &gt;&lt;img loading="lazy" width="4032" height="3024" src="https://cdn.elstec.cn/39/13.jpg" /&gt;&lt;/figure&gt;
&lt;/div&gt;&lt;p&gt;拍的第一张给我有一种&lt;code&gt;macOS Mojave&lt;/code&gt;的错觉，后面也坐了骆驼，动物毛发都很顺摸着很舒服，坐着的体验就差强人意了，风景还是超级好的，但是出去已经很晚了，大概19:30。&lt;/p&gt;&lt;p&gt;9号的日程里面，&lt;code&gt;石油小镇&lt;/code&gt;感觉没意思就没有去，天气不是很好，拍照也没怎么拍。&lt;/p&gt;&lt;figure class="pswp-item" style="flex: 37.5" &gt;&lt;img loading="lazy" width="1080" height="1440" src="https://cdn.elstec.cn/39/14.jpg" /&gt;&lt;/figure&gt;&lt;p&gt;&lt;code&gt;阳关遗址&lt;/code&gt;路上拍的唐僧西行。&lt;/p&gt;&lt;figure class="pswp-item" style="flex: 77.71084337349397" &gt;&lt;img loading="lazy" width="1677" height="1079" src="https://cdn.elstec.cn/39/15.jpg" /&gt;&lt;/figure&gt;&lt;p&gt;下午快到&lt;code&gt;雅丹地貌&lt;/code&gt;的时候已经开始下小雨了，结果也没怎么看，随便拍了几张照片就回酒店了。&lt;/p&gt;&lt;p&gt;10号主要就是去两个地方，&lt;code&gt;翡翠湖&lt;/code&gt;和&lt;code&gt;茶卡盐湖&lt;/code&gt;，但是由于当天晚上下雨了，早上去的&lt;code&gt;翡翠湖&lt;/code&gt;路上就算坐在车里也很难受，但好在门票免费，风景超好，云也很好看，不过鞋子要刷一下了，全是泥。&lt;/p&gt;&lt;div class="photos"&gt;
&lt;figure class="pswp-item" style="flex: 96.33580705009277" &gt;&lt;img loading="lazy" width="2077" height="1078" src="https://cdn.elstec.cn/39/16.jpg" /&gt;&lt;/figure&gt;
&lt;figure class="pswp-item" style="flex: 88.8682745825603" &gt;&lt;img loading="lazy" width="1916" height="1078" src="https://cdn.elstec.cn/39/17.jpg" /&gt;&lt;/figure&gt;
&lt;/div&gt;&lt;p&gt;下午就去了&lt;code&gt;茶卡盐湖&lt;/code&gt;，还好带了一件冲锋衣，风真的好大，温度也很低。&lt;/p&gt;&lt;div class="photos"&gt;
&lt;figure class="pswp-item" style="flex: 96.93877551020408" &gt;&lt;img loading="lazy" width="2090" height="1078" src="https://cdn.elstec.cn/39/18.jpg" /&gt;&lt;figcaption&gt;路上拍的&lt;/figcaption&gt;&lt;/figure&gt;
&lt;figure class="pswp-item" style="flex: 28.098958333333332" &gt;&lt;img loading="lazy" width="1079" height="1920" src="https://cdn.elstec.cn/39/19.jpg" /&gt;&lt;/figure&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;茶卡盐湖&lt;/code&gt;里面我们选择做观光小火车。酒店住的汉庭，前台还有奶茶服务，买了一杯黑糖啥的，齁甜。&lt;/p&gt;&lt;p&gt;11号就主要是&lt;code&gt;青海湖&lt;/code&gt;以及&lt;code&gt;塔尔寺&lt;/code&gt;，其他都选择不去了。&lt;/p&gt;&lt;div class="photos"&gt;
&lt;figure class="pswp-item" style="flex: 79.17439703153988" &gt;&lt;img loading="lazy" width="1707" height="1078" src="https://cdn.elstec.cn/39/20.jpg" /&gt;&lt;/figure&gt;
&lt;figure class="pswp-item" style="flex: 28.128258602711156" &gt;&lt;img loading="lazy" width="1079" height="1918" src="https://cdn.elstec.cn/39/21.jpg" /&gt;&lt;/figure&gt;
&lt;/div&gt;&lt;p&gt;路上手机随便拍了两张，西北地区风景真的好，经济也是真的不发达，厕所也是年久失修。&lt;/p&gt;&lt;p&gt;到了&lt;code&gt;青海湖景区&lt;/code&gt;，先是买了观光车到轮船处，买了船票，坐船用时大概1个小时，&lt;code&gt;青海湖&lt;/code&gt;的景色那是真的很震撼了。&lt;/p&gt;&lt;div class="photos"&gt;
&lt;figure class="pswp-item" style="flex: 78.20037105751392" &gt;&lt;img loading="lazy" width="1686" height="1078" src="https://cdn.elstec.cn/39/22.jpg" /&gt;&lt;/figure&gt;
&lt;figure class="pswp-item" style="flex: 66.66666666666667" &gt;&lt;img loading="lazy" width="1440" height="1080" src="https://cdn.elstec.cn/39/23.jpg" /&gt;&lt;/figure&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;青海湖&lt;/code&gt;回来的中午找了一家清真饭馆买了一碗牛肉面，给脸了，就一片牛肉，吃完上厕所还被收1块md&lt;/p&gt;&lt;figure class="pswp-item" style="flex: 66.66666666666667" &gt;&lt;img loading="lazy" width="1440" height="1080" src="https://cdn.elstec.cn/39/24.jpg" /&gt;&lt;/figure&gt;&lt;p&gt;&lt;code&gt;塔尔寺&lt;/code&gt;我没拍照，除了大了一点，看起来就跟普通寺庙没啥区别。&lt;/p&gt;&lt;p&gt;最后一天坐国航的&lt;code&gt;CA1910&lt;/code&gt;，航班延误了3个半小时，成功登机之后还没有空调，整一个桑拿飞机，不过一部电影消磨时光非常好。&lt;/p&gt;&lt;figure class="pswp-item" style="flex: 23.106546854942234" &gt;&lt;img loading="lazy" width="1080" height="2337" src="https://cdn.elstec.cn/39/25.jpg" /&gt;&lt;/figure&gt;&lt;p&gt;下飞机从萧山机场走高速大概50分钟到家。&lt;/p&gt;</description><author>i@elstec.cn (jcjyxjs)</author><guid isPermaLink="true">/archives/20210815/</guid><pubDate>Sun, 15 Aug 2021 00:00:00 +0806</pubDate></item><item><title>关于使用GitHub Actions云编译LEDE固件更新说明</title><link>/archives/20210821/</link><description>&lt;html&gt;
    &lt;div class="warn"&gt;
        &lt;strong&gt;
            教程类文章具有时效性，看清楚发布日期，超过一定日子文章内容可能失效，仅仅作为参考。
        &lt;/strong&gt;
    &lt;/div&gt;
&lt;/html&gt;
&lt;p&gt;点击&lt;code&gt;Use this template&lt;/code&gt;按钮，创建&lt;code&gt;repo&lt;/code&gt;。然后给该&lt;code&gt;repo&lt;/code&gt;启用&lt;code&gt;Actions&lt;/code&gt;功能。&lt;/p&gt;&lt;html&gt;
&lt;div class="uttpl"&gt;
    &lt;a href="https://github.com/P3TERX/Actions-OpenWrt/generate" id="utp"&gt;Use this template&lt;/a&gt;
&lt;/div&gt;
&lt;/html&gt;
&lt;p&gt;项目&lt;code&gt;GitHub&lt;/code&gt;地址：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://github.com/P3TERX/Actions-OpenWrt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;编辑&lt;code&gt;diy-part1.sh&lt;/code&gt;文件，可以更改固件是&lt;code&gt;XXRPlus&lt;/code&gt;还是&lt;code&gt;Passwall&lt;/code&gt;，想用什么就给倒数两行其中一行取消注释就生效。&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# Copyright (c) 2019-2020 P3TERX &amp;lt;https://p3terx.com&amp;gt;&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# This is free software, licensed under the MIT License.&lt;/span&gt;
&lt;span class="c1"&gt;# See /LICENSE for more information.&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# https://github.com/P3TERX/Actions-OpenWrt&lt;/span&gt;
&lt;span class="c1"&gt;# File name: diy-part1.sh&lt;/span&gt;
&lt;span class="c1"&gt;# Description: OpenWrt DIY script part 1 (Before Update feeds)&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;

&lt;span class="c1"&gt;# Uncomment a feed source&lt;/span&gt;
&lt;span class="c1"&gt;#sed -i &amp;#39;s/^#\(.*helloworld\)/\1/&amp;#39; feeds.conf.default&lt;/span&gt;

&lt;span class="c1"&gt;# Add a feed source&lt;/span&gt;
&lt;span class="c1"&gt;#echo &amp;#39;src-git helloworld https://github.com/fw876/helloworld&amp;#39; &amp;gt;&amp;gt;feeds.conf.default&lt;/span&gt;
&lt;span class="c1"&gt;#echo &amp;#39;src-git passwall https://github.com/xiaorouji/openwrt-passwall&amp;#39; &amp;gt;&amp;gt;feeds.conf.default&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;编辑&lt;code&gt;diy-part2.sh&lt;/code&gt;文件，修改最后一行可以更改固件默认后台地址。这个无关紧要反正在shell里面也可以通过&lt;code&gt;vi etc/config/network&lt;/code&gt;命令更改。&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# Copyright (c) 2019-2020 P3TERX &amp;lt;https://p3terx.com&amp;gt;&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# This is free software, licensed under the MIT License.&lt;/span&gt;
&lt;span class="c1"&gt;# See /LICENSE for more information.&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# https://github.com/P3TERX/Actions-OpenWrt&lt;/span&gt;
&lt;span class="c1"&gt;# File name: diy-part2.sh&lt;/span&gt;
&lt;span class="c1"&gt;# Description: OpenWrt DIY script part 2 (After Update feeds)&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;

&lt;span class="c1"&gt;# Modify default IP&lt;/span&gt;
&lt;span class="c1"&gt;#sed -i &amp;#39;s/192.168.1.1/192.168.50.5/g&amp;#39; package/base-files/files/bin/config_generate&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;然后进入&lt;code&gt;actions&lt;/code&gt;，选&lt;code&gt;Build OpenWrt&lt;/code&gt;任务，单击&lt;code&gt;Run workflow&lt;/code&gt;，可以选择分支和是否启用&lt;code&gt;SSH&lt;/code&gt;，默认是&lt;code&gt;false&lt;/code&gt;，改成&lt;code&gt;true&lt;/code&gt;就可以使用&lt;code&gt;SSH&lt;/code&gt;功能，最后运行即可。&lt;/p&gt;&lt;figure class="pswp-item" style="flex: 108.89781859931114" &gt;&lt;img loading="lazy" width="1897" height="871" src="https://cdn.elstec.cn/40/1.png" /&gt;&lt;/figure&gt;&lt;html&gt;
&lt;p style="display:inline;"&gt;希望本文可以帮到你&lt;/p&gt;
&lt;img src="https://cdn.elstec.cn/images/file_1016567.jpg" width="55px" height="55px" style="display: inline;"&gt;
&lt;/html&gt;
</description><author>i@elstec.cn (jcjyxjs)</author><guid isPermaLink="true">/archives/20210821/</guid><pubDate>Sat, 21 Aug 2021 00:00:00 +0806</pubDate></item><item><title>关于编译OpenWrt固件中找不到luci-app-ssr-plus更新说明</title><link>/archives/202108212/</link><description>&lt;html&gt;
    &lt;div class="warn"&gt;
        &lt;strong&gt;
            教程类文章具有时效性，看清楚发布日期，超过一定日子文章内容可能失效，仅仅作为参考。
        &lt;/strong&gt;
    &lt;/div&gt;
&lt;/html&gt;
&lt;h2&gt;云编译&lt;/h2&gt;
&lt;p&gt;云编译用户看上一篇更新说明：&lt;a href="https://elstec.cn/archives/20210821/"&gt;关于使用GitHub Actions云编译LEDE固件更新说明&lt;/a&gt;&lt;/p&gt;&lt;h2&gt;本地编译用户开始&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git clone https://github.com/coolsnowwolf/lede
&lt;span class="nb"&gt;cd&lt;/span&gt; lede
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;修改&lt;code&gt;feeds.conf.default&lt;/code&gt;文件 &lt;strong&gt;（以下是2021年8月21日的文件）&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;src-git packages https://github.com/coolsnowwolf/packages
src-git luci https://github.com/coolsnowwolf/luci
src-git routing https://git.openwrt.org/feed/routing.git
src-git telephony https://git.openwrt.org/feed/telephony.git
#src-git video https://github.com/openwrt/video.git
#src-git targets https://github.com/openwrt/targets.git
#src-git oldpackages http://git.openwrt.org/packages.git
#src-link custom /usr/src/openwrt/custom-feed
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;可以发现并没有&lt;code&gt;XXRPlus&lt;/code&gt;或&lt;code&gt;PassWall&lt;/code&gt;，自行添加&lt;code&gt;XXRPlus&lt;/code&gt;或&lt;code&gt;PassWall&lt;/code&gt;。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;src-git helloworld https://github.com/fw876/helloworld
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;src-git passwall https://github.com/xiaorouji/openwrt-passwall
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;最后保存。&lt;/p&gt;&lt;p&gt;我的博客即将同步至腾讯云+社区，邀请大家一同入驻：&lt;a href="https://cloud.tencent.com/developer/support-plan?invite_code=b70aijpftod5"&gt;https://cloud.tencent.com/developer/support-plan?invite_code=b70aijpftod5&lt;/a&gt;&lt;/p&gt;</description><author>i@elstec.cn (jcjyxjs)</author><guid isPermaLink="true">/archives/202108212/</guid><pubDate>Sat, 21 Aug 2021 23:00:00 +0806</pubDate></item><item><title>使用腾讯云Webify托管静态网站</title><link>/archives/20210913/</link><description>&lt;div class="notice"&gt;绑定自定义域名需要提前完成备案&lt;/div&gt;&lt;p&gt;更多更详细配置参考官方文档：&lt;a href="https://webify.cloudbase.net/docs/introduction/"&gt;&lt;a href="https://webify.cloudbase.net/docs/introduction/"&gt;https://webify.cloudbase.net/docs/introduction/&lt;/a&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;目前（2021年9月13日）仅支持部署静态网站，后期会支持&lt;code&gt;serverless&lt;/code&gt;能力，类似于&lt;code&gt;Vercel&lt;/code&gt;。本文以介绍接入静态网站为主。&lt;/p&gt;&lt;p&gt;登录&lt;code&gt;webify&lt;/code&gt;后台设置&lt;code&gt;Git&lt;/code&gt;平台账号授权。&lt;a href="https://console.cloud.tencent.com/webify/set"&gt;&lt;a href="https://console.cloud.tencent.com/webify/set"&gt;https://console.cloud.tencent.com/webify/set&lt;/a&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;然后在&lt;a href="https://console.cloud.tencent.com/webify/new"&gt;Webify 新建应用页面&lt;/a&gt;新建一个模板或选择导入&lt;code&gt;Git&lt;/code&gt;平台仓库&lt;/p&gt;&lt;figure class="pswp-item" style="flex: 58.70229007633588" &gt;&lt;img loading="lazy" width="769" height="655" src="https://cdn.elstec.cn/41/1.png" /&gt;&lt;/figure&gt;&lt;p&gt;应用名称随意，如果使用这些静态程序的话，可以直接使用预设，自己的程序不在内也可自定义构建命令，输出目录和安装命令。（已经构建完成的静态网站只需要设置目录为&lt;code&gt;.&lt;/code&gt;即可，其他都无需设置。）&lt;/p&gt;&lt;figure class="pswp-item" style="flex: 25.0" &gt;&lt;img loading="lazy" width="319" height="638" src="https://cdn.elstec.cn/41/2.png" /&gt;&lt;/figure&gt;&lt;p&gt;然后就是等待几分钟部署完成。可以在应用列表找到该应用。默认分配了一个超长的应用域名，可以在应用设置→自定义域名设置绑定自定义域名。后续在&lt;code&gt;Git&lt;/code&gt;平台上有新提交&lt;code&gt;Webify&lt;/code&gt;也会自动同步并构建。&lt;/p&gt;&lt;blockquote&gt;
&lt;p&gt;定价：Webify 费用参考：1000PV 网站预计消耗 0.21 元/天，300 元基本覆盖大部分个人站点的两年托管费用。如个别站点流量较大可额外联系申请。被刷流量提交工单审核也会免除被刷的费用&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;缺点：自定义域名CDN控制并没有接入内容分发网络控制台，控制选项不够多。删除应用不会马上把绑定的自定义域名删除，需要等待2-3小时系统删除或先删除域名再删应用。&lt;/p&gt;</description><author>i@elstec.cn (jcjyxjs)</author><guid isPermaLink="true">/archives/20210913/</guid><pubDate>Mon, 13 Sep 2021 01:00:00 +0806</pubDate></item><item><title>使用Coding Devops+自动构建以及部署博客</title><link>/archives/20210915/</link><description>&lt;h1&gt;看前须知&lt;/h1&gt;
&lt;p&gt;本文只是我使用&lt;code&gt;Coding Devops+&lt;/code&gt;部署博客以及自动&lt;code&gt;Push&lt;/code&gt;到&lt;code&gt;GitHub&lt;/code&gt;的过程记录，我只用到了&lt;code&gt;repo&lt;/code&gt;和&lt;code&gt;ci&lt;/code&gt;功能，不需要一模一样，&lt;code&gt;hexo&lt;/code&gt;等可以效仿，其他仅作参考，有问题评论留言即可。&lt;strong&gt;（看懂本文需要会一点&lt;code&gt;Git&lt;/code&gt;，&lt;code&gt;Linux&lt;/code&gt;服务器相关内容）&lt;/strong&gt;&lt;/p&gt;&lt;h1&gt;开始&lt;/h1&gt;
&lt;p&gt;实现的最终效果如图。&lt;/p&gt;&lt;figure class="pswp-item"  size-undefined&gt;&lt;img loading="lazy" width="-1" height="-1" src="https://cdn.elstec.cn/42/1.svg" /&gt;&lt;/figure&gt;&lt;p&gt;&lt;code&gt;Coding&lt;/code&gt;这个实现起来不是很难，我自己用也不需要什么测试，迭代。&lt;/p&gt;&lt;p&gt;在想要构建的仓库里&lt;code&gt;创建构建计划&lt;/code&gt;→&lt;code&gt;自定义构建过程&lt;/code&gt;→&lt;code&gt;不使用代码仓库&lt;/code&gt;。不适用代码仓库的原因是如果一开始就使用选定的仓库，运行&lt;code&gt;CI&lt;/code&gt;会全局覆盖&lt;code&gt;Git&lt;/code&gt;信息导致后续无法&lt;code&gt;Push&lt;/code&gt;到&lt;code&gt;Github&lt;/code&gt;。&lt;/p&gt;&lt;p&gt;不选代码仓库就没有检出这一步骤，第一步创建&lt;code&gt;执行Shell脚本&lt;/code&gt;，内容就是&lt;code&gt;clone&lt;/code&gt;托管在&lt;code&gt;Coding&lt;/code&gt;的仓库，不使用&lt;code&gt;SSH&lt;/code&gt;方式，改成账号密码。除了账号密码以外的部分可以在仓库里找到。&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git clone https://账号:密码@e.coding.net/用户名/项目名/项目名.git
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;Coding CI&lt;/code&gt;的初始目录如下，所有的操作都会在这个目录里进行，需要注意的是：如果有&lt;code&gt;cd&lt;/code&gt;操作，&lt;code&gt;cd&lt;/code&gt;结束之后会自动回到这个目录，所以所有的步骤都要&lt;code&gt;cd&lt;/code&gt;或者直接把内容拖到这个目录。&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;/root/workspace
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;然后先删除项目内的&lt;code&gt;.git&lt;/code&gt;文件夹（改也行），然后就是设置&lt;code&gt;Git&lt;/code&gt;信息。在&lt;code&gt;Coding CI&lt;/code&gt;内无法输入账号密码，所以&lt;code&gt;Push&lt;/code&gt;到&lt;code&gt;Github&lt;/code&gt;需要&lt;code&gt;Github&lt;/code&gt;的&lt;code&gt;Personal access tokens&lt;/code&gt;。在这里新建&lt;code&gt;token&lt;/code&gt;，&lt;a href="https://github.com/settings/tokens"&gt;&lt;a href="https://github.com/settings/tokens"&gt;https://github.com/settings/tokens&lt;/a&gt;&lt;/a&gt; 并把对&lt;code&gt;repo&lt;/code&gt;的控制勾上。&lt;/p&gt;&lt;p&gt;格式跟&lt;code&gt;Coding&lt;/code&gt;那个仓库差不多，可以免密&lt;code&gt;Clone&lt;/code&gt;，&lt;code&gt;Push&lt;/code&gt;等。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://token@github.com/用户名/项目名.git
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;所有&lt;code&gt;Git&lt;/code&gt;的操作就跟在本地一样，唯一的区别就是&lt;code&gt;CI&lt;/code&gt;的服务器&lt;code&gt;Push&lt;/code&gt;到&lt;code&gt;Github&lt;/code&gt;很快hhh，格式如下，最后分支那里不用加&lt;code&gt;HEAD&lt;/code&gt;。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;git push https://token@github.com/用户名/项目名.git branch
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;整仓&lt;code&gt;Push&lt;/code&gt;到我的&lt;code&gt;Github&lt;/code&gt;之后，开始构建并生成我的静态内容。我的博客和&lt;code&gt;GitHub Pages&lt;/code&gt;是两个仓库所以我最终会提交两次，博客那个仓库主要做个备份。&lt;/p&gt;&lt;p&gt;我的博客用的&lt;code&gt;Maverick&lt;/code&gt;，所以需要用到&lt;code&gt;Python&lt;/code&gt;，版本只要大于3.6就可以，&lt;code&gt;CI&lt;/code&gt;默认就有环境&lt;code&gt;SDK&lt;/code&gt;内置。具体看官方文档。没有想要的环境或版本可以用自定义&lt;code&gt;docker&lt;/code&gt;。&lt;/p&gt;&lt;p&gt;&lt;a href="https://help.coding.net/docs/ci/ways.html?&amp;amp;_ga=2.233204055.856802041.1631519683-1446587655.1624866774#%E9%A2%84%E8%A3%85%E7%9A%84%E8%BD%AF%E4%BB%B6-SDK"&gt;&lt;a href="https://help.coding.net/docs/ci/ways.html?&amp;amp;_ga=2.233204055.856802041.1631519683-1446587655.1624866774#%E9%A2%84%E8%A3%85%E7%9A%84%E8%BD%AF%E4%BB%B6-SDK"&gt;https://help.coding.net/docs/ci/ways.html?&amp;amp;_ga=2.233204055.856802041.1631519683-1446587655.1624866774#%E9%A2%84%E8%A3%85%E7%9A%84%E8%BD%AF%E4%BB%B6-SDK&lt;/a&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;查看文档可以看到和&lt;code&gt;Python&lt;/code&gt;有关的环境有：&lt;code&gt;python3/pip3: 3.9、3.8、3.7&lt;/code&gt;。&lt;/p&gt;&lt;p&gt;首先我更新默认的&lt;code&gt;pip&lt;/code&gt;版本，其实这个无所谓。&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;python3.9 -m pip install --upgrade pip
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;然后就是安装依赖&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pip3.9 install -r requirements.txt
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;最后生成&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;python3.9 mvrk.py --config ./demo_src/config.py --source_dir ./demo_src/ --build_dir ./dist/
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;部署完成之后我需要推送到我的服务器，创建&lt;code&gt;执行 Pipeline 脚本&lt;/code&gt;，可以用私钥也可以用账号密码，具体参考官方文档：&lt;a href="https://help.coding.net/docs/ci/deploy/ssh.html"&gt;&lt;a href="https://help.coding.net/docs/ci/deploy/ssh.html"&gt;https://help.coding.net/docs/ci/deploy/ssh.html&lt;/a&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;如果是图形化编辑器，复制从&lt;code&gt;def&lt;/code&gt;开始的内容即可，文本编辑器参考文档。填写好&lt;code&gt;IP&lt;/code&gt;，端口等之后，可以看到&lt;code&gt;credentialsId&lt;/code&gt;，凭据ID可以在当前项目页面左下角找到项目设置，开发者选项，就有凭据选项。新建凭据，可以用私钥也可以设置账号密码。添加完成后把凭据ID替换到&lt;code&gt;执行的Pipeline脚本&lt;/code&gt;内。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[https://jcjyxjs.coding.net/p/项目名称/setting/connection?page=1](https://jcjyxjs.coding.net/p/项目名称/setting/connection?page=1)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;成功连接服务器之后，就等于直接操作服务器，首先我需要把生成的内容传输到我的服务器上，&lt;code&gt;form&lt;/code&gt;就是&lt;code&gt;CI&lt;/code&gt;目录，&lt;code&gt;into&lt;/code&gt;就是我服务器目录。然后就是替换操作了。&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;sshPut&lt;/span&gt; &lt;span class="nl"&gt;remote:&lt;/span&gt; &lt;span class="n"&gt;remote&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nl"&gt;from:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/root/workspace&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nl"&gt;into:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/xxxxxxxx/&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kt"&gt;def&lt;/span&gt; &lt;span class="n"&gt;remote&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;[:]&lt;/span&gt;
          &lt;span class="n"&gt;remote&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;名字随便&amp;#39;&lt;/span&gt;
          &lt;span class="n"&gt;remote&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;allowAnyHosts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;
          &lt;span class="n"&gt;remote&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;host&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;服务器IP&amp;#39;&lt;/span&gt;
          &lt;span class="n"&gt;remote&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;port&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;SSH端口&lt;/span&gt;
          &lt;span class="n"&gt;remote&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;用户&amp;#39;&lt;/span&gt;

          &lt;span class="c1"&gt;// 把「CODING 凭据管理」中的「凭据 ID」填入 credentialsId，而 id_rsa 无需修改&lt;/span&gt;
          &lt;span class="n"&gt;withCredentials&lt;/span&gt;&lt;span class="o"&gt;([&lt;/span&gt;&lt;span class="n"&gt;sshUserPrivateKey&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nl"&gt;credentialsId:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;xxxxxxxxxxxxx&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nl"&gt;keyFileVariable:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;id_rsa&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;)])&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;remote&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;identityFile&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;id_rsa&lt;/span&gt;

            &lt;span class="c1"&gt;// SSH 上传文件到远端服务器&lt;/span&gt;
            &lt;span class="n"&gt;sshPut&lt;/span&gt; &lt;span class="nl"&gt;remote:&lt;/span&gt; &lt;span class="n"&gt;remote&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nl"&gt;from:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/tmp/tmp.tar.gz&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nl"&gt;into:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/tmp/&amp;#39;&lt;/span&gt;
            &lt;span class="c1"&gt;// 解压缩&lt;/span&gt;
            &lt;span class="n"&gt;sshCommand&lt;/span&gt; &lt;span class="nl"&gt;remote:&lt;/span&gt; &lt;span class="n"&gt;remote&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nl"&gt;command:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;tar -zxf /tmp/tmp.tar.gz -C /tmp/&amp;quot;&lt;/span&gt;
            &lt;span class="n"&gt;sshCommand&lt;/span&gt; &lt;span class="nl"&gt;remote:&lt;/span&gt; &lt;span class="n"&gt;remote&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nl"&gt;sudo:&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nl"&gt;command:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;mkdir -p /var/www/example-site&amp;quot;&lt;/span&gt;
            &lt;span class="n"&gt;sshCommand&lt;/span&gt; &lt;span class="nl"&gt;remote:&lt;/span&gt; &lt;span class="n"&gt;remote&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nl"&gt;sudo:&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nl"&gt;command:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;cp -R /tmp/site/* /var/www/example-site/&amp;quot;&lt;/span&gt;
            &lt;span class="n"&gt;sshCommand&lt;/span&gt; &lt;span class="nl"&gt;remote:&lt;/span&gt; &lt;span class="n"&gt;remote&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nl"&gt;sudo:&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nl"&gt;command:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;cp -R /tmp/apache2/ /etc/&amp;quot;&lt;/span&gt;
            &lt;span class="c1"&gt;// 重启 apache2&lt;/span&gt;
            &lt;span class="n"&gt;sshCommand&lt;/span&gt; &lt;span class="nl"&gt;remote:&lt;/span&gt; &lt;span class="n"&gt;remote&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nl"&gt;sudo:&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nl"&gt;command:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;a2ensite example.com&amp;quot;&lt;/span&gt;
            &lt;span class="n"&gt;sshCommand&lt;/span&gt; &lt;span class="nl"&gt;remote:&lt;/span&gt; &lt;span class="n"&gt;remote&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nl"&gt;sudo:&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nl"&gt;command:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;a2enmod headers rewrite ssl&amp;quot;&lt;/span&gt;
            &lt;span class="n"&gt;sshCommand&lt;/span&gt; &lt;span class="nl"&gt;remote:&lt;/span&gt; &lt;span class="n"&gt;remote&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nl"&gt;sudo:&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nl"&gt;command:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;systemctl reload apache2&amp;quot;&lt;/span&gt;
          &lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;最后回到&lt;code&gt;CI&lt;/code&gt;，还是创建&lt;code&gt;Shell命令&lt;/code&gt;，我也不会其他方法，只能先删不需要的然后把&lt;code&gt;dist&lt;/code&gt;目录内的东西移动到工作目录，然后&lt;code&gt;clone&lt;/code&gt;在&lt;code&gt;GitHub&lt;/code&gt;的仓库，把&lt;code&gt;.git&lt;/code&gt;移动到工作目录，删除&lt;code&gt;clone&lt;/code&gt;的产物，最后&lt;code&gt;git push&lt;/code&gt;，&lt;code&gt;git init&lt;/code&gt;然后添加远程仓库就是&lt;code&gt;push&lt;/code&gt;不上去也不知道什么原因，我只能先这样。其他东西参考上文。&lt;/p&gt;&lt;p&gt;在每个步骤的最后我都添加了一步，推送消息到企业微信，这还挺方便的，执行到哪里了也都知道。&lt;/p&gt;&lt;p&gt;这个&lt;code&gt;CI&lt;/code&gt;没有用代码仓库所以不会检测&lt;code&gt;repo&lt;/code&gt;然后触发自动构建，所以在触发规则中，选择&lt;code&gt;API&lt;/code&gt;触发，可以直接生成&lt;code&gt;CURL&lt;/code&gt;触发命令，项目令牌和密码也可以一键生成，时间可以自定义。然后复制这个触发命令。&lt;/p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;curl -u &amp;lt;项目令牌用户名&amp;gt;:&amp;lt;项目令牌密码&amp;gt; &lt;span class="se"&gt;\&lt;/span&gt;
   -v -X POST  &lt;span class="s1"&gt;&amp;#39;自己的CI点生成可以看到&amp;#39;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
   -H &lt;span class="s1"&gt;&amp;#39;Content-Type: application/json&amp;#39;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
   -d &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;
&lt;span class="s1"&gt;    {&lt;/span&gt;
&lt;span class="s1"&gt;    &amp;quot;ref&amp;quot;: &amp;quot;master&amp;quot;,&lt;/span&gt;
&lt;span class="s1"&gt;    &amp;quot;envs&amp;quot;: []&lt;/span&gt;
&lt;span class="s1"&gt;}&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;再次创建一个&lt;code&gt;CI&lt;/code&gt;，使用&lt;code&gt;Coding&lt;/code&gt;的仓库，然后创建一个&lt;code&gt;Shell命令&lt;/code&gt;，把刚刚复制的&lt;code&gt;CURL&lt;/code&gt;命令粘贴进来然后保存就可以。&lt;/p&gt;&lt;p&gt;最终就会是：我本地提交&lt;code&gt;git&lt;/code&gt;到&lt;code&gt;Coding&lt;/code&gt;的仓库，触发器这个&lt;code&gt;CI&lt;/code&gt;检测到仓库变化然后运行，运行的内容就是启动另外一个&lt;code&gt;CI&lt;/code&gt;，触发器结束任务，主要的&lt;code&gt;CI&lt;/code&gt;开始运行我指定的内容。官方文档写的非常好，可读性极强。&lt;/p&gt;</description><author>i@elstec.cn (jcjyxjs)</author><guid isPermaLink="true">/archives/20210915/</guid><pubDate>Wed, 15 Sep 2021 01:00:00 +0806</pubDate></item></channel></rss>